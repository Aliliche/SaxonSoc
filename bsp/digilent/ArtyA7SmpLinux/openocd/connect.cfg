set cpu_count 2

adapter_khz 40000
adapter_nsrst_delay 260
jtag_ntrst_delay 250
ftdi_tdo_sample_edge falling

jtag newtap saxon bridge -expected-id 0x10001fff -irlen 4 -ircapture 0x1 -irmask 0xF

for {set i 0} {$i < $cpu_count} {incr i} {
    target create saxon.cpu$i vexriscv -endian little -chain-position saxon.bridge -coreid $i -dbgbase [expr $i*0x1000+0x10B80000]
    vexriscv readWaitCycles 40
    vexriscv cpuConfigFile $CPU0_YAML
}

for {set i 0} {$i < $cpu_count} {incr i} {
    targets saxon.cpu$i
    poll_period 50
    init
    soft_reset_halt
}

targets saxon.cpu0
load_image software/standalone/sdramInit/build/sdramInit.bin 0x10A00000
echo "SDRAM init"
resume 0x10A00000
wait_halt
echo "SDRAM done"
